RewriteEngine On

# =====================================================
# SÉCURITÉ : BLOQUER FICHIERS SENSIBLES
# =====================================================
<FilesMatch "(\.env|\.git|\.htaccess|composer\.(json|lock)|phpunit\.xml|\.DS_Store)$">
  Require all denied
</FilesMatch>

# =====================================================
# EMPÊCHER LE LISTING DE DOSSIERS
# =====================================================
Options -Indexes

# =====================================================
# REDIRECTION VERS /sahp/public
# =====================================================

# 1) Rediriger la racine vers /sahp/public/
RewriteRule ^$ sahp/public/ [L,R=301]

# 2) Si la requête vise déjà /sahp/public/ => ne touche pas
RewriteCond %{REQUEST_URI} !^/sahp/public/ [NC]

# 3) Si le fichier/dossier existe à la racine => ne pas réécrire (évite bugs)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# 4) Tout le reste vers /sahp/public/
RewriteRule ^(.*)$ sahp/public/$1 [L]
